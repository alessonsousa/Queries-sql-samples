SELECT DISTINCT

  SMATRICULA.RA AS 'MATRICULA',
  PPESSOA.NOME AS 'NOME DO ALUNO',
  SSTATUS.DESCRICAO AS 'STATUS NA DISCIPLINA',
  SPLETIVO.CODPERLET AS 'PERIODO LETIVO',
  SCURSO.NOME AS 'CURSO',
  SDISCIPLINA.NOME AS 'NOME DA DISCIPLINA',
  CONVERT(DECIMAL(10,2),SDISCIPLINA.NUMCREDITOS) AS 'CREDITOS ACADÊMICOS',
  CONVERT(DECIMAL(10,2),SDISCGRADE.NUMCREDITOSCOB) AS 'CREDITOS FINANCEIROS',
  
 (SELECT CONVERT(DECIMAL(10,2),NOTAFALTA) FROM SNOTAETAPA
	WHERE SNOTAETAPA.CODCOLIGADA=SMATRICULA.CODCOLIGADA
	AND SNOTAETAPA.RA=SMATRICULA.RA
	AND SNOTAETAPA.IDTURMADISC=SMATRICULA.IDTURMADISC
	AND TIPOETAPA='N'
	AND CODETAPA=1) AS 'AV1',
	
(SELECT CONVERT(DECIMAL(10,2),NOTAFALTA) FROM SNOTAETAPA
	WHERE SNOTAETAPA.CODCOLIGADA=SMATRICULA.CODCOLIGADA
	AND SNOTAETAPA.RA=SMATRICULA.RA
	AND SNOTAETAPA.IDTURMADISC=SMATRICULA.IDTURMADISC
	AND TIPOETAPA='N'
	AND CODETAPA=2) AS 'AV2',
	
(SELECT CONVERT(DECIMAL(10,2),NOTAFALTA) FROM SNOTAETAPA
	WHERE SNOTAETAPA.CODCOLIGADA=SMATRICULA.CODCOLIGADA
	AND SNOTAETAPA.RA=SMATRICULA.RA
	AND SNOTAETAPA.IDTURMADISC=SMATRICULA.IDTURMADISC
	AND TIPOETAPA='N'
	AND CODETAPA=4) AS 'AVF',
	
(SELECT CONVERT(DECIMAL(10,2),NOTAFALTA) FROM SNOTAETAPA
	WHERE SNOTAETAPA.CODCOLIGADA=SMATRICULA.CODCOLIGADA
	AND SNOTAETAPA.RA=SMATRICULA.RA
	AND SNOTAETAPA.IDTURMADISC=SMATRICULA.IDTURMADISC
	AND TIPOETAPA='N'
	AND CODETAPA=5) AS 'MF'
	
FROM STURMADISC 

 INNER JOIN SMATRICULA (NOLOCK) ON
	SMATRICULA.CODCOLIGADA = STURMADISC.CODCOLIGADA
	AND SMATRICULA.IDTURMADISC = STURMADISC.IDTURMADISC
  
  INNER JOIN SALUNO (NOLOCK) ON
	SMATRICULA.CODCOLIGADA = SALUNO.CODCOLIGADA
	 AND SMATRICULA.RA = SALUNO.RA
    
  INNER JOIN SSTATUS (NOLOCK) ON
	SMATRICULA.CODCOLIGADA = SSTATUS.CODCOLIGADA
    AND SMATRICULA.CODSTATUS = SSTATUS.CODSTATUS
    
    INNER JOIN SHABILITACAOFILIAL (NOLOCK)
  INNER JOIN SHABILITACAO (NOLOCK)  ON 
	SHABILITACAOFILIAL.CODCOLIGADA = SHABILITACAO.CODCOLIGADA
	  AND SHABILITACAOFILIAL.CODCURSO = SHABILITACAO.CODCURSO
	AND SHABILITACAOFILIAL.CODHABILITACAO = SHABILITACAO.CODHABILITACAO ON 
	  STURMADISC.CODCOLIGADA = SHABILITACAOFILIAL.CODCOLIGADA
	AND STURMADISC.IDHABILITACAOFILIAL = SHABILITACAOFILIAL.IDHABILITACAOFILIAL
    
    INNER JOIN SCURSO (NOLOCK) ON
	SHABILITACAOFILIAL.CODCOLIGADA = SCURSO.CODCOLIGADA
    AND SHABILITACAOFILIAL.CODCURSO = SCURSO.CODCURSO
 
	INNER JOIN PPESSOA (NOLOCK) ON
	SALUNO.CODPESSOA = PPESSOA.CODIGO     
   
	 INNER JOIN SPLETIVO (NOLOCK) ON
	STURMADISC.CODCOLIGADA = SPLETIVO.CODCOLIGADA
    AND STURMADISC.IDPERLET = SPLETIVO.IDPERLET
     
	INNER JOIN SDISCIPLINA (NOLOCK) ON
	STURMADISC.CODCOLIGADA = SDISCIPLINA.CODCOLIGADA
    AND STURMADISC.CODDISC = SDISCIPLINA.CODDISC

	INNER JOIN SDISCGRADE (NOLOCK) ON
		SDISCGRADE.CODDISC = SDISCIPLINA.CODDISC

WHERE 

	STURMADISC.CODFILIAL = 1
	AND SCURSO.CODCURSO = '9'
	AND SALUNO.RA IN ('2016110419',
'2018110256',
'2017210009',
'2017210262',
'2018110313',
'2017210029',
'2017210263',
'2017210163',
'2016210542',
'2017210027',
'2018210150',
'2017210305',
'2017210290',
'2017210141',
'2021110402',
'2018110229',
'2017210314',
'2019110164',
'2017210041',
'2018110253',
'2018110287',
'2019210111',
'2017210246',
'2021110581',
'2018110064',
'2017210215',
'2018110096',
'2017210028',
'2018210034',
'2017210317',
'2017210247',
'2018210123',
'2017210232',
'2017210023',
'2017210115',
'2017210037',
'2017210001',
'2017210014',
'2017210268',
'2017210142',
'2017210140',
'201710989')
ORDER BY SMATRICULA.RA, SPLETIVO.CODPERLET