

SELECT DISTINCT
    
    STURMADISC.CODDISC,
	STURMADISC.CODTURMA,
    SDISCIPLINA.NOME			[DISCIPLINAS],
	SHORARIOPROFESSOR.IDPROFESSORTURMA

FROM
    SPLETIVO
    INNER JOIN STURMADISC (NOLOCK) ON
			STURMADISC.IDPERLET = SPLETIVO.IDPERLET
    INNER JOIN SHABILITACAOFILIAL (NOLOCK) ON
			SHABILITACAOFILIAL.IDHABILITACAOFILIAL = STURMADISC.IDHABILITACAOFILIAL
    INNER JOIN STURNO (NOLOCK) ON
			SHABILITACAOFILIAL.CODCOLIGADA = STURNO.CODCOLIGADA
    INNER JOIN SCURSO (NOLOCK) ON
			SCURSO.CODCURSO = SHABILITACAOFILIAL.CODCURSO
    INNER JOIN SDISCIPLINA (NOLOCK) ON
			SDISCIPLINA.CODDISC = STURMADISC.CODDISC
	INNER JOIN SHORARIOTURMA (NOLOCK) ON
			SHORARIOTURMA.CODCOLIGADA = STURMADISC.CODCOLIGADA
		AND SHORARIOTURMA.IDTURMADISC = STURMADISC.IDTURMADISC
	INNER JOIN SHORARIOPROFESSOR (NOLOCK) ON
			SHORARIOPROFESSOR.CODCOLIGADA = SHORARIOTURMA.CODCOLIGADA
		AND SHORARIOPROFESSOR.IDHORARIOTURMA = SHORARIOTURMA.IDHORARIOTURMA

WHERE
		SPLETIVO.CODPERLET = '2022.1'


  
ORDER BY
		SDISCIPLINA.NOME

--SELECT IDPROFESSORTURMA FROM SHORARIOPROFESSOR

--SELECT * FROM GLINKSREL WHERE MASTERTABLE = 'SHORARIOPROFESSOR';